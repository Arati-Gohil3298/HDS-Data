{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 0,
   "metadata": {
    "application/vnd.databricks.v1+cell": {
     "cellMetadata": {
      "byteLimit": 2048000,
      "rowLimit": 10000
     },
     "inputWidgets": {},
     "nuid": "96c5e6f7-05c4-4f9c-a3a2-9548a3d2bb6f",
     "showTitle": false,
     "tableResultSettingsMap": {},
     "title": ""
    }
   },
   "outputs": [],
   "source": [
    "spark\n",
    "from pyspark.sql import SparkSession"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 0,
   "metadata": {
    "application/vnd.databricks.v1+cell": {
     "cellMetadata": {
      "byteLimit": 2048000,
      "rowLimit": 10000
     },
     "inputWidgets": {},
     "nuid": "118b65a9-604d-4cc4-93c2-8c4b89951541",
     "showTitle": false,
     "tableResultSettingsMap": {},
     "title": ""
    }
   },
   "outputs": [],
   "source": [
    "# File location and type\n",
    "file_location = \"C:/Users/Aarti Gohil/Downloads/PGYR2023_P01302025_01212025.csv\"\n",
    "file_location = \"C:/Users/Aarti Gohil/Downloads/PHPRFL_P01302025_01212025.csv\"\n",
    "file_type = \"zip\""
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 0,
   "metadata": {
    "application/vnd.databricks.v1+cell": {
     "cellMetadata": {
      "byteLimit": 2048000,
      "rowLimit": 10000
     },
     "inputWidgets": {},
     "nuid": "0be4e20d-3273-43c8-b4b6-26f014e31b41",
     "showTitle": false,
     "tableResultSettingsMap": {},
     "title": ""
    }
   },
   "outputs": [],
   "source": [
    "# File location and type\n",
    "file_location_open_payments_1 = \"/FileStore/tables/OP_REMOVED_DELETED_PGYR2023_P01302025_01212025-1.csv\"\n",
    "file_location_open_payment_2 = \"/FileStore/tables/OP_DTL_OWNRSHP_PGYR2023_P01302025_01212025-1.csv\"\n",
    "file_location_open_payments_3 =  \"/FileStore/tables/OP_DTL_RSRCH_PGYR2023_P01302025_01212025.csv\"\n",
    "file_location_open_payments_4 = \"/FileStore/tables/OP_DTL_GNRL_PGYR2023_P01302025_01212025.7z\"\n",
    "\n",
    "file_location_covered_recipient = \"/FileStore/tables/OP_CVRD_RCPNT_PRFL_SPLMTL_P01302025_01212025-2.csv\"\n",
    "\n",
    "\n",
    "file_type = \"csv\"  \n",
    "file_type = \"7z\"\n",
    "\n",
    "# CSV options\n",
    "infer_schema = \"true\"  \n",
    "first_row_is_header = \"true\"  \n",
    "delimiter = \",\" \n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 0,
   "metadata": {
    "application/vnd.databricks.v1+cell": {
     "cellMetadata": {
      "byteLimit": 2048000,
      "rowLimit": 10000
     },
     "inputWidgets": {},
     "nuid": "27791d5c-4258-4676-b5bf-38ed1053f32a",
     "showTitle": false,
     "tableResultSettingsMap": {},
     "title": ""
    }
   },
   "outputs": [
    {
     "output_type": "stream",
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Out[90]: 32512"
     ]
    }
   ],
   "source": [
    "dbutils.fs.cp(\"dbfs:/FileStore/tables/OP_DTL_GNRL_PGYR2023_P01302025_01212025.7z\", \"file:/tmp/general.7z\")\n",
    "\n",
    "import os\n",
    "os.system(\"7z x /tmp/general.7z -o/tmp/\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 0,
   "metadata": {
    "application/vnd.databricks.v1+cell": {
     "cellMetadata": {
      "byteLimit": 2048000,
      "rowLimit": 10000
     },
     "inputWidgets": {},
     "nuid": "d6086c8f-158f-4679-90e8-3a6f2ca6be4e",
     "showTitle": false,
     "tableResultSettingsMap": {},
     "title": ""
    }
   },
   "outputs": [
    {
     "output_type": "display_data",
     "data": {
      "text/html": [
       "<style scoped>\n",
       "  .table-result-container {\n",
       "    max-height: 300px;\n",
       "    overflow: auto;\n",
       "  }\n",
       "  table, th, td {\n",
       "    border: 1px solid black;\n",
       "    border-collapse: collapse;\n",
       "  }\n",
       "  th, td {\n",
       "    padding: 5px;\n",
       "  }\n",
       "  th {\n",
       "    text-align: left;\n",
       "  }\n",
       "</style><div class='table-result-container'><table class='table-result'><thead style='background-color: white'><tr><th>path</th><th>name</th><th>size</th><th>modificationTime</th></tr></thead><tbody><tr><td>dbfs:/FileStore/tables/OP_CVRD_RCPNT_PRFL_SPLMTL_P01302025_01212025-1.csv</td><td>OP_CVRD_RCPNT_PRFL_SPLMTL_P01302025_01212025-1.csv</td><td>357419225</td><td>1742779979000</td></tr><tr><td>dbfs:/FileStore/tables/OP_CVRD_RCPNT_PRFL_SPLMTL_P01302025_01212025-2.csv</td><td>OP_CVRD_RCPNT_PRFL_SPLMTL_P01302025_01212025-2.csv</td><td>357419225</td><td>1742781249000</td></tr><tr><td>dbfs:/FileStore/tables/OP_CVRD_RCPNT_PRFL_SPLMTL_P01302025_01212025.csv</td><td>OP_CVRD_RCPNT_PRFL_SPLMTL_P01302025_01212025.csv</td><td>357419225</td><td>1742779946000</td></tr><tr><td>dbfs:/FileStore/tables/OP_DTL_GNRL_PGYR2023_P01302025_01212025.7z</td><td>OP_DTL_GNRL_PGYR2023_P01302025_01212025.7z</td><td>756941040</td><td>1742790109000</td></tr><tr><td>dbfs:/FileStore/tables/OP_DTL_OWNRSHP_PGYR2023_P01302025_01212025-1.csv</td><td>OP_DTL_OWNRSHP_PGYR2023_P01302025_01212025-1.csv</td><td>1827342</td><td>1742780405000</td></tr><tr><td>dbfs:/FileStore/tables/OP_DTL_OWNRSHP_PGYR2023_P01302025_01212025.csv</td><td>OP_DTL_OWNRSHP_PGYR2023_P01302025_01212025.csv</td><td>1827342</td><td>1742768557000</td></tr><tr><td>dbfs:/FileStore/tables/OP_DTL_RSRCH_PGYR2023_P01302025_01212025.csv</td><td>OP_DTL_RSRCH_PGYR2023_P01302025_01212025.csv</td><td>992593986</td><td>1742780604000</td></tr><tr><td>dbfs:/FileStore/tables/OP_PGYR2023_README_P01302025.txt</td><td>OP_PGYR2023_README_P01302025.txt</td><td>5422</td><td>1742768558000</td></tr><tr><td>dbfs:/FileStore/tables/OP_REMOVED_DELETED_PGYR2023_P01302025_01212025-1.csv</td><td>OP_REMOVED_DELETED_PGYR2023_P01302025_01212025-1.csv</td><td>158460</td><td>1742780401000</td></tr><tr><td>dbfs:/FileStore/tables/OP_REMOVED_DELETED_PGYR2023_P01302025_01212025.csv</td><td>OP_REMOVED_DELETED_PGYR2023_P01302025_01212025.csv</td><td>158460</td><td>1742768554000</td></tr><tr><td>dbfs:/FileStore/tables/PGYR2023_P01302025_01212025-1.zip</td><td>PGYR2023_P01302025_01212025-1.zip</td><td>789005271</td><td>1742753019000</td></tr><tr><td>dbfs:/FileStore/tables/PGYR2023_P01302025_01212025-2.zip</td><td>PGYR2023_P01302025_01212025-2.zip</td><td>789005271</td><td>1742754856000</td></tr><tr><td>dbfs:/FileStore/tables/PGYR2023_P01302025_01212025-3.zip</td><td>PGYR2023_P01302025_01212025-3.zip</td><td>789005271</td><td>1742764077000</td></tr><tr><td>dbfs:/FileStore/tables/PGYR2023_P01302025_01212025-4.zip</td><td>PGYR2023_P01302025_01212025-4.zip</td><td>789005271</td><td>1742765415000</td></tr><tr><td>dbfs:/FileStore/tables/PGYR2023_P01302025_01212025-5.zip</td><td>PGYR2023_P01302025_01212025-5.zip</td><td>789005271</td><td>1742768992000</td></tr><tr><td>dbfs:/FileStore/tables/PGYR2023_P01302025_01212025-6.zip</td><td>PGYR2023_P01302025_01212025-6.zip</td><td>789005271</td><td>1742774852000</td></tr><tr><td>dbfs:/FileStore/tables/PGYR2023_P01302025_01212025-7.zip</td><td>PGYR2023_P01302025_01212025-7.zip</td><td>789005271</td><td>1742776123000</td></tr><tr><td>dbfs:/FileStore/tables/PGYR2023_P01302025_01212025.zip</td><td>PGYR2023_P01302025_01212025.zip</td><td>789005271</td><td>1742751999000</td></tr><tr><td>dbfs:/FileStore/tables/PHPRFL_P01302025_01212025-1.zip</td><td>PHPRFL_P01302025_01212025-1.zip</td><td>82966770</td><td>1742752900000</td></tr><tr><td>dbfs:/FileStore/tables/PHPRFL_P01302025_01212025-2.zip</td><td>PHPRFL_P01302025_01212025-2.zip</td><td>82966770</td><td>1742754747000</td></tr><tr><td>dbfs:/FileStore/tables/PHPRFL_P01302025_01212025-3.zip</td><td>PHPRFL_P01302025_01212025-3.zip</td><td>82966770</td><td>1742763967000</td></tr><tr><td>dbfs:/FileStore/tables/PHPRFL_P01302025_01212025-4.zip</td><td>PHPRFL_P01302025_01212025-4.zip</td><td>82966770</td><td>1742765302000</td></tr><tr><td>dbfs:/FileStore/tables/PHPRFL_P01302025_01212025-5.zip</td><td>PHPRFL_P01302025_01212025-5.zip</td><td>82966770</td><td>1742768821000</td></tr><tr><td>dbfs:/FileStore/tables/PHPRFL_P01302025_01212025-6.zip</td><td>PHPRFL_P01302025_01212025-6.zip</td><td>82966770</td><td>1742774682000</td></tr><tr><td>dbfs:/FileStore/tables/PHPRFL_P01302025_01212025-7.zip</td><td>PHPRFL_P01302025_01212025-7.zip</td><td>82966770</td><td>1742775998000</td></tr><tr><td>dbfs:/FileStore/tables/PHPRFL_P01302025_01212025.zip</td><td>PHPRFL_P01302025_01212025.zip</td><td>82966770</td><td>1742751900000</td></tr></tbody></table></div>"
      ]
     },
     "metadata": {
      "application/vnd.databricks.v1+output": {
       "addedWidgets": {},
       "aggData": [],
       "aggError": "",
       "aggOverflow": false,
       "aggSchema": [],
       "aggSeriesLimitReached": false,
       "aggType": "",
       "arguments": {},
       "columnCustomDisplayInfos": {},
       "data": [
        [
         "dbfs:/FileStore/tables/OP_CVRD_RCPNT_PRFL_SPLMTL_P01302025_01212025-1.csv",
         "OP_CVRD_RCPNT_PRFL_SPLMTL_P01302025_01212025-1.csv",
         357419225,
         1742779979000
        ],
        [
         "dbfs:/FileStore/tables/OP_CVRD_RCPNT_PRFL_SPLMTL_P01302025_01212025-2.csv",
         "OP_CVRD_RCPNT_PRFL_SPLMTL_P01302025_01212025-2.csv",
         357419225,
         1742781249000
        ],
        [
         "dbfs:/FileStore/tables/OP_CVRD_RCPNT_PRFL_SPLMTL_P01302025_01212025.csv",
         "OP_CVRD_RCPNT_PRFL_SPLMTL_P01302025_01212025.csv",
         357419225,
         1742779946000
        ],
        [
         "dbfs:/FileStore/tables/OP_DTL_GNRL_PGYR2023_P01302025_01212025.7z",
         "OP_DTL_GNRL_PGYR2023_P01302025_01212025.7z",
         756941040,
         1742790109000
        ],
        [
         "dbfs:/FileStore/tables/OP_DTL_OWNRSHP_PGYR2023_P01302025_01212025-1.csv",
         "OP_DTL_OWNRSHP_PGYR2023_P01302025_01212025-1.csv",
         1827342,
         1742780405000
        ],
        [
         "dbfs:/FileStore/tables/OP_DTL_OWNRSHP_PGYR2023_P01302025_01212025.csv",
         "OP_DTL_OWNRSHP_PGYR2023_P01302025_01212025.csv",
         1827342,
         1742768557000
        ],
        [
         "dbfs:/FileStore/tables/OP_DTL_RSRCH_PGYR2023_P01302025_01212025.csv",
         "OP_DTL_RSRCH_PGYR2023_P01302025_01212025.csv",
         992593986,
         1742780604000
        ],
        [
         "dbfs:/FileStore/tables/OP_PGYR2023_README_P01302025.txt",
         "OP_PGYR2023_README_P01302025.txt",
         5422,
         1742768558000
        ],
        [
         "dbfs:/FileStore/tables/OP_REMOVED_DELETED_PGYR2023_P01302025_01212025-1.csv",
         "OP_REMOVED_DELETED_PGYR2023_P01302025_01212025-1.csv",
         158460,
         1742780401000
        ],
        [
         "dbfs:/FileStore/tables/OP_REMOVED_DELETED_PGYR2023_P01302025_01212025.csv",
         "OP_REMOVED_DELETED_PGYR2023_P01302025_01212025.csv",
         158460,
         1742768554000
        ],
        [
         "dbfs:/FileStore/tables/PGYR2023_P01302025_01212025-1.zip",
         "PGYR2023_P01302025_01212025-1.zip",
         789005271,
         1742753019000
        ],
        [
         "dbfs:/FileStore/tables/PGYR2023_P01302025_01212025-2.zip",
         "PGYR2023_P01302025_01212025-2.zip",
         789005271,
         1742754856000
        ],
        [
         "dbfs:/FileStore/tables/PGYR2023_P01302025_01212025-3.zip",
         "PGYR2023_P01302025_01212025-3.zip",
         789005271,
         1742764077000
        ],
        [
         "dbfs:/FileStore/tables/PGYR2023_P01302025_01212025-4.zip",
         "PGYR2023_P01302025_01212025-4.zip",
         789005271,
         1742765415000
        ],
        [
         "dbfs:/FileStore/tables/PGYR2023_P01302025_01212025-5.zip",
         "PGYR2023_P01302025_01212025-5.zip",
         789005271,
         1742768992000
        ],
        [
         "dbfs:/FileStore/tables/PGYR2023_P01302025_01212025-6.zip",
         "PGYR2023_P01302025_01212025-6.zip",
         789005271,
         1742774852000
        ],
        [
         "dbfs:/FileStore/tables/PGYR2023_P01302025_01212025-7.zip",
         "PGYR2023_P01302025_01212025-7.zip",
         789005271,
         1742776123000
        ],
        [
         "dbfs:/FileStore/tables/PGYR2023_P01302025_01212025.zip",
         "PGYR2023_P01302025_01212025.zip",
         789005271,
         1742751999000
        ],
        [
         "dbfs:/FileStore/tables/PHPRFL_P01302025_01212025-1.zip",
         "PHPRFL_P01302025_01212025-1.zip",
         82966770,
         1742752900000
        ],
        [
         "dbfs:/FileStore/tables/PHPRFL_P01302025_01212025-2.zip",
         "PHPRFL_P01302025_01212025-2.zip",
         82966770,
         1742754747000
        ],
        [
         "dbfs:/FileStore/tables/PHPRFL_P01302025_01212025-3.zip",
         "PHPRFL_P01302025_01212025-3.zip",
         82966770,
         1742763967000
        ],
        [
         "dbfs:/FileStore/tables/PHPRFL_P01302025_01212025-4.zip",
         "PHPRFL_P01302025_01212025-4.zip",
         82966770,
         1742765302000
        ],
        [
         "dbfs:/FileStore/tables/PHPRFL_P01302025_01212025-5.zip",
         "PHPRFL_P01302025_01212025-5.zip",
         82966770,
         1742768821000
        ],
        [
         "dbfs:/FileStore/tables/PHPRFL_P01302025_01212025-6.zip",
         "PHPRFL_P01302025_01212025-6.zip",
         82966770,
         1742774682000
        ],
        [
         "dbfs:/FileStore/tables/PHPRFL_P01302025_01212025-7.zip",
         "PHPRFL_P01302025_01212025-7.zip",
         82966770,
         1742775998000
        ],
        [
         "dbfs:/FileStore/tables/PHPRFL_P01302025_01212025.zip",
         "PHPRFL_P01302025_01212025.zip",
         82966770,
         1742751900000
        ]
       ],
       "datasetInfos": [],
       "dbfsResultPath": null,
       "isJsonSchema": true,
       "metadata": {},
       "overflow": false,
       "plotOptions": {
        "customPlotOptions": {},
        "displayType": "table",
        "pivotAggregation": null,
        "pivotColumns": null,
        "xColumns": null,
        "yColumns": null
       },
       "removedWidgets": [],
       "schema": [
        {
         "metadata": "{}",
         "name": "path",
         "type": "\"string\""
        },
        {
         "metadata": "{}",
         "name": "name",
         "type": "\"string\""
        },
        {
         "metadata": "{}",
         "name": "size",
         "type": "\"long\""
        },
        {
         "metadata": "{}",
         "name": "modificationTime",
         "type": "\"long\""
        }
       ],
       "type": "table"
      }
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "display(dbutils.fs.ls(\"dbfs:/FileStore/tables/\"))\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 0,
   "metadata": {
    "application/vnd.databricks.v1+cell": {
     "cellMetadata": {
      "byteLimit": 2048000,
      "rowLimit": 10000
     },
     "inputWidgets": {},
     "nuid": "d7943d04-56ff-41a7-a2af-a76328145eb6",
     "showTitle": false,
     "tableResultSettingsMap": {},
     "title": ""
    }
   },
   "outputs": [
    {
     "output_type": "stream",
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Out[96]: True"
     ]
    }
   ],
   "source": [
    "dbutils.fs.cp(\n",
    "    \"dbfs:/FileStore/tables/PGYR2023_P01302025_01212025.zip\",\n",
    "    \"file:/tmp/general.zip\"\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 0,
   "metadata": {
    "application/vnd.databricks.v1+cell": {
     "cellMetadata": {
      "byteLimit": 2048000,
      "rowLimit": 10000
     },
     "inputWidgets": {},
     "nuid": "37825b58-8e48-42c1-b006-9f937c09cd8e",
     "showTitle": false,
     "tableResultSettingsMap": {},
     "title": ""
    }
   },
   "outputs": [],
   "source": [
    "import zipfile\n",
    "\n",
    "with zipfile.ZipFile(\"/tmp/general.zip\", 'r') as zip_ref:\n",
    "    zip_ref.extractall(\"/tmp/\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 0,
   "metadata": {
    "application/vnd.databricks.v1+cell": {
     "cellMetadata": {
      "byteLimit": 2048000,
      "rowLimit": 10000
     },
     "inputWidgets": {},
     "nuid": "7d48c1c9-0254-4a55-a3e4-77b5fd6be6ad",
     "showTitle": false,
     "tableResultSettingsMap": {},
     "title": ""
    }
   },
   "outputs": [
    {
     "output_type": "stream",
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "hsperfdata_root\nRtmpJ3WfGb\nsystemd-private-de06a02ba26e4ad29443065b2ee1af83-ntp.service-5PK27f\ncustom-spark.conf\nRserv\n.general.zip.crc\n.ICE-unix\n.X11-unix\n.Test-unix\n.general.7z.crc\nr.zip\nOP_PGYR2023_README_P01302025.txt\nOP_REMOVED_DELETED_PGYR2023_P01302025_01212025.csv\nOP_DTL_RSRCH_PGYR2023_P01302025_01212025.csv\ng.zip\nOP_DTL_OWNRSHP_PGYR2023_P01302025_01212025.csv\n.g.zip.crc\nchauffeur-env.sh\nopG\nsystemd-private-de06a02ba26e4ad29443065b2ee1af83-systemd-logind.service-utGswg\n.XIM-unix\nsystemd-private-de06a02ba26e4ad29443065b2ee1af83-apache2.service-Xh7TNg\nOP_DTL_GNRL_PGYR2023_P01302025_01212025.csv\ndriver-daemon-params\ndriver-daemon.pid\nchauffeur-daemon.pid\n.r.zip.crc\ngeneral.zip\ndriver-env.sh\nchauffeur-daemon-params\ntmp.CTdK8DovUt\ngeneral.7z\nsystemd-private-de06a02ba26e4ad29443065b2ee1af83-systemd-resolved.service-KXiWAi\nopR\n.font-unix\n"
     ]
    }
   ],
   "source": [
    "import os\n",
    "\n",
    "# List all files in /tmp/ to see the actual extracted filenames\n",
    "for file_name in os.listdir(\"/tmp/\"):\n",
    "    print(file_name)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 0,
   "metadata": {
    "application/vnd.databricks.v1+cell": {
     "cellMetadata": {
      "byteLimit": 2048000,
      "rowLimit": 10000
     },
     "inputWidgets": {},
     "nuid": "b1c2c1c9-06a2-4763-bf5e-585f1213c4a8",
     "showTitle": false,
     "tableResultSettingsMap": {},
     "title": ""
    }
   },
   "outputs": [
    {
     "output_type": "stream",
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "+-----------+----------------------+---------------------+--------------------+----------------------+----------------------------+---------------------+----------------------------+-----------------------------+---------------------------+-----------------------------+-----------------------------------------------+-----------------------------------------------+---------------+---------------+------------------+-----------------+------------------+---------------------+--------------------------------+--------------------------------+--------------------------------+--------------------------------+--------------------------------+--------------------------------+-----------------------------+-----------------------------+-----------------------------+-----------------------------+-----------------------------+-----------------------------+-------------------------------------+-------------------------------------+-------------------------------------+-------------------------------------+-------------------------------------+---------------------------------------------------------+-----------------------------------------------------------+-------------------------------------------------------------+--------------------------------------------------------------+----------------------------------------------------------------+---------------------------------+---------------+-------------------------------------------+------------------------------------+--------------------------------------+--------------+---------------+-----------------+-----------------------------+---------------------------------------+-----------------------------------------------------------------+-----------------+----------------------------------------------+----------------------+------------------------------+----------+------------------------------+-------------------------+---------------------------------+---------------------------------------------------------+--------------------------------------+--------------------------------------------------------+-----------------------------------+-----------------------------------------+---------------------------------+---------------------------------------------------------+--------------------------------------+--------------------------------------------------------+-----------------------------------+-----------------------------------------+---------------------------------+---------------------------------------------------------+--------------------------------------+--------------------------------------------------------+-----------------------------------+-----------------------------------------+---------------------------------+---------------------------------------------------------+--------------------------------------+--------------------------------------------------------+-----------------------------------+-----------------------------------------+---------------------------------+---------------------------------------------------------+--------------------------------------+--------------------------------------------------------+-----------------------------------+-----------------------------------------+------------+------------------------+\n|Change_Type|Covered_Recipient_Type|Teaching_Hospital_CCN|Teaching_Hospital_ID|Teaching_Hospital_Name|Covered_Recipient_Profile_ID|Covered_Recipient_NPI|Covered_Recipient_First_Name|Covered_Recipient_Middle_Name|Covered_Recipient_Last_Name|Covered_Recipient_Name_Suffix|Recipient_Primary_Business_Street_Address_Line1|Recipient_Primary_Business_Street_Address_Line2| Recipient_City|Recipient_State|Recipient_Zip_Code|Recipient_Country|Recipient_Province|Recipient_Postal_Code|Covered_Recipient_Primary_Type_1|Covered_Recipient_Primary_Type_2|Covered_Recipient_Primary_Type_3|Covered_Recipient_Primary_Type_4|Covered_Recipient_Primary_Type_5|Covered_Recipient_Primary_Type_6|Covered_Recipient_Specialty_1|Covered_Recipient_Specialty_2|Covered_Recipient_Specialty_3|Covered_Recipient_Specialty_4|Covered_Recipient_Specialty_5|Covered_Recipient_Specialty_6|Covered_Recipient_License_State_code1|Covered_Recipient_License_State_code2|Covered_Recipient_License_State_code3|Covered_Recipient_License_State_code4|Covered_Recipient_License_State_code5|Submitting_Applicable_Manufacturer_or_Applicable_GPO_Name|Applicable_Manufacturer_or_Applicable_GPO_Making_Payment_ID|Applicable_Manufacturer_or_Applicable_GPO_Making_Payment_Name|Applicable_Manufacturer_or_Applicable_GPO_Making_Payment_State|Applicable_Manufacturer_or_Applicable_GPO_Making_Payment_Country|Total_Amount_of_Payment_USDollars|Date_of_Payment|Number_of_Payments_Included_in_Total_Amount|Form_of_Payment_or_Transfer_of_Value|Nature_of_Payment_or_Transfer_of_Value|City_of_Travel|State_of_Travel|Country_of_Travel|Physician_Ownership_Indicator|Third_Party_Payment_Recipient_Indicator|Name_of_Third_Party_Entity_Receiving_Payment_or_Transfer_of_Value|Charity_Indicator|Third_Party_Equals_Covered_Recipient_Indicator|Contextual_Information|Delay_in_Publication_Indicator| Record_ID|Dispute_Status_for_Publication|Related_Product_Indicator|Covered_or_Noncovered_Indicator_1|Indicate_Drug_or_Biological_or_Device_or_Medical_Supply_1|Product_Category_or_Therapeutic_Area_1|Name_of_Drug_or_Biological_or_Device_or_Medical_Supply_1|Associated_Drug_or_Biological_NDC_1|Associated_Device_or_Medical_Supply_PDI_1|Covered_or_Noncovered_Indicator_2|Indicate_Drug_or_Biological_or_Device_or_Medical_Supply_2|Product_Category_or_Therapeutic_Area_2|Name_of_Drug_or_Biological_or_Device_or_Medical_Supply_2|Associated_Drug_or_Biological_NDC_2|Associated_Device_or_Medical_Supply_PDI_2|Covered_or_Noncovered_Indicator_3|Indicate_Drug_or_Biological_or_Device_or_Medical_Supply_3|Product_Category_or_Therapeutic_Area_3|Name_of_Drug_or_Biological_or_Device_or_Medical_Supply_3|Associated_Drug_or_Biological_NDC_3|Associated_Device_or_Medical_Supply_PDI_3|Covered_or_Noncovered_Indicator_4|Indicate_Drug_or_Biological_or_Device_or_Medical_Supply_4|Product_Category_or_Therapeutic_Area_4|Name_of_Drug_or_Biological_or_Device_or_Medical_Supply_4|Associated_Drug_or_Biological_NDC_4|Associated_Device_or_Medical_Supply_PDI_4|Covered_or_Noncovered_Indicator_5|Indicate_Drug_or_Biological_or_Device_or_Medical_Supply_5|Product_Category_or_Therapeutic_Area_5|Name_of_Drug_or_Biological_or_Device_or_Medical_Supply_5|Associated_Drug_or_Biological_NDC_5|Associated_Device_or_Medical_Supply_PDI_5|Program_Year|Payment_Publication_Date|\n+-----------+----------------------+---------------------+--------------------+----------------------+----------------------------+---------------------+----------------------------+-----------------------------+---------------------------+-----------------------------+-----------------------------------------------+-----------------------------------------------+---------------+---------------+------------------+-----------------+------------------+---------------------+--------------------------------+--------------------------------+--------------------------------+--------------------------------+--------------------------------+--------------------------------+-----------------------------+-----------------------------+-----------------------------+-----------------------------+-----------------------------+-----------------------------+-------------------------------------+-------------------------------------+-------------------------------------+-------------------------------------+-------------------------------------+---------------------------------------------------------+-----------------------------------------------------------+-------------------------------------------------------------+--------------------------------------------------------------+----------------------------------------------------------------+---------------------------------+---------------+-------------------------------------------+------------------------------------+--------------------------------------+--------------+---------------+-----------------+-----------------------------+---------------------------------------+-----------------------------------------------------------------+-----------------+----------------------------------------------+----------------------+------------------------------+----------+------------------------------+-------------------------+---------------------------------+---------------------------------------------------------+--------------------------------------+--------------------------------------------------------+-----------------------------------+-----------------------------------------+---------------------------------+---------------------------------------------------------+--------------------------------------+--------------------------------------------------------+-----------------------------------+-----------------------------------------+---------------------------------+---------------------------------------------------------+--------------------------------------+--------------------------------------------------------+-----------------------------------+-----------------------------------------+---------------------------------+---------------------------------------------------------+--------------------------------------+--------------------------------------------------------+-----------------------------------+-----------------------------------------+---------------------------------+---------------------------------------------------------+--------------------------------------+--------------------------------------------------------+-----------------------------------+-----------------------------------------+------------+------------------------+\n|    CHANGED|  Covered Recipient...|               220162|                9984|  Adventhealth Orlando|                        null|                 null|                        null|                         null|                       null|                         null|                               601 E Rollins St|                                           null|        Orlando|             FL|             32803|    United States|              null|                 null|                            null|                            null|                            null|                            null|                            null|                            null|                         null|                         null|                         null|                         null|                         null|                         null|                                 null|                                 null|                                 null|                                 null|                                 null|                                     Integra LifeScien...|                                               100000010950|                                         Integra LifeScien...|                                                            NJ|                                                   United States|                          2000.00|     07/20/2023|                                          1|                Cash or cash equi...|                                 Grant|          null|           null|             null|                           No|                   No Third Party Pa...|                                                             null|             null|                                          null|                  null|                            No|1031636873|                            No|                      Yes|                          Covered|                                                   Device|                   Neuro Critical Care|                                           CODMAN CERTAS|                               null|                           10381780529033|                             null|                                                     null|                                  null|                                                    null|                               null|                                     null|                             null|                                                     null|                                  null|                                                    null|                               null|                                     null|                             null|                                                     null|                                  null|                                                    null|                               null|                                     null|                             null|                                                     null|                                  null|                                                    null|                               null|                                     null|        2023|              01/30/2025|\n|    CHANGED|  Covered Recipient...|               220162|                9984|  Carle Foundation ...|                        null|                 null|                        null|                         null|                       null|                         null|                            2300 N Vermilion St|                                           null|       Danville|             IL|             61832|    United States|              null|                 null|                            null|                            null|                            null|                            null|                            null|                            null|                         null|                         null|                         null|                         null|                         null|                         null|                                 null|                                 null|                                 null|                                 null|                                 null|                                     Integra LifeScien...|                                               100000010950|                                         Integra LifeScien...|                                                            NJ|                                                   United States|                          1500.00|     11/03/2023|                                          1|                Cash or cash equi...|                                 Grant|          null|           null|             null|                           No|                   No Third Party Pa...|                                                             null|             null|                                          null|                  null|                            No|1031636879|                            No|                      Yes|                          Covered|                                                   Device|                   Neuro Critical Care|                                           CODMAN CERTAS|                               null|                           10381780529033|                             null|                                                     null|                                  null|                                                    null|                               null|                                     null|                             null|                                                     null|                                  null|                                                    null|                               null|                                     null|                             null|                                                     null|                                  null|                                                    null|                               null|                                     null|                             null|                                                     null|                                  null|                                                    null|                               null|                                     null|        2023|              01/30/2025|\n|    CHANGED|  Covered Recipient...|               220162|                9984|  St. Josephs Hospi...|                        null|                 null|                        null|                         null|                       null|                         null|                           4975 N Dysart Rd ...|                                           null|Litchfield Park|             AZ|             85340|    United States|              null|                 null|                            null|                            null|                            null|                            null|                            null|                            null|                         null|                         null|                         null|                         null|                         null|                         null|                                 null|                                 null|                                 null|                                 null|                                 null|                                     Integra LifeScien...|                                               100000010950|                                         Integra LifeScien...|                                                            NJ|                                                   United States|                          2500.00|     03/21/2023|                                          1|                Cash or cash equi...|                                 Grant|          null|           null|             null|                           No|                   No Third Party Pa...|                                                             null|             null|                                          null|                  null|                            No|1031636885|                            No|                      Yes|                          Covered|                                                   Device|                   Neuro Critical Care|                                           CODMAN CERTAS|                               null|                           10381780529033|                             null|                                                     null|                                  null|                                                    null|                               null|                                     null|                             null|                                                     null|                                  null|                                                    null|                               null|                                     null|                             null|                                                     null|                                  null|                                                    null|                               null|                                     null|                             null|                                                     null|                                  null|                                                    null|                               null|                                     null|        2023|              01/30/2025|\n|    CHANGED|  Covered Recipient...|               220162|                9984|  St. Josephs Hospi...|                        null|                 null|                        null|                         null|                       null|                         null|                           4975 N Dysart Rd ...|                                           null|Litchfield Park|             AZ|             85340|    United States|              null|                 null|                            null|                            null|                            null|                            null|                            null|                            null|                         null|                         null|                         null|                         null|                         null|                         null|                                 null|                                 null|                                 null|                                 null|                                 null|                                     Integra LifeScien...|                                               100000010950|                                         Integra LifeScien...|                                                            NJ|                                                   United States|                          3000.00|     04/14/2023|                                          1|                Cash or cash equi...|                                 Grant|          null|           null|             null|                           No|                   No Third Party Pa...|                                                             null|             null|                                          null|                  null|                            No|1031636889|                            No|                      Yes|                          Covered|                                                   Device|                   Neuro Critical Care|                                           CODMAN CERTAS|                               null|                           10381780529033|                             null|                                                     null|                                  null|                                                    null|                               null|                                     null|                             null|                                                     null|                                  null|                                                    null|                               null|                                     null|                             null|                                                     null|                                  null|                                                    null|                               null|                                     null|                             null|                                                     null|                                  null|                                                    null|                               null|                                     null|        2023|              01/30/2025|\n|    CHANGED|  Covered Recipient...|               220162|                9984|  Uc Davis Medical ...|                        null|                 null|                        null|                         null|                       null|                         null|                             2315 Stockton Blvd|                                           null|     Sacramento|             CA|             95817|    United States|              null|                 null|                            null|                            null|                            null|                            null|                            null|                            null|                         null|                         null|                         null|                         null|                         null|                         null|                                 null|                                 null|                                 null|                                 null|                                 null|                                     Integra LifeScien...|                                               100000010950|                                         Integra LifeScien...|                                                            NJ|                                                   United States|                          3921.61|     04/30/2023|                                          1|                Cash or cash equi...|                             Honoraria|          null|           null|             null|                           No|                   No Third Party Pa...|                                                             null|             null|                                          null|                  null|                            No|1031636896|                            No|                      Yes|                          Covered|                                                   Device|                   Neuro Critical Care|                                           CODMAN CERTAS|                               null|                           10381780529033|                          Covered|                                                   Device|                   Neuro Critical Care|                                            CUSA CLARITY|                               null|                           10381780126232|                             null|                                                     null|                                  null|                                                    null|                               null|                                     null|                             null|                                                     null|                                  null|                                                    null|                               null|                                     null|                             null|                                                     null|                                  null|                                                    null|                               null|                                     null|        2023|              01/30/2025|\n+-----------+----------------------+---------------------+--------------------+----------------------+----------------------------+---------------------+----------------------------+-----------------------------+---------------------------+-----------------------------+-----------------------------------------------+-----------------------------------------------+---------------+---------------+------------------+-----------------+------------------+---------------------+--------------------------------+--------------------------------+--------------------------------+--------------------------------+--------------------------------+--------------------------------+-----------------------------+-----------------------------+-----------------------------+-----------------------------+-----------------------------+-----------------------------+-------------------------------------+-------------------------------------+-------------------------------------+-------------------------------------+-------------------------------------+---------------------------------------------------------+-----------------------------------------------------------+-------------------------------------------------------------+--------------------------------------------------------------+----------------------------------------------------------------+---------------------------------+---------------+-------------------------------------------+------------------------------------+--------------------------------------+--------------+---------------+-----------------+-----------------------------+---------------------------------------+-----------------------------------------------------------------+-----------------+----------------------------------------------+----------------------+------------------------------+----------+------------------------------+-------------------------+---------------------------------+---------------------------------------------------------+--------------------------------------+--------------------------------------------------------+-----------------------------------+-----------------------------------------+---------------------------------+---------------------------------------------------------+--------------------------------------+--------------------------------------------------------+-----------------------------------+-----------------------------------------+---------------------------------+---------------------------------------------------------+--------------------------------------+--------------------------------------------------------+-----------------------------------+-----------------------------------------+---------------------------------+---------------------------------------------------------+--------------------------------------+--------------------------------------------------------+-----------------------------------+-----------------------------------------+---------------------------------+---------------------------------------------------------+--------------------------------------+--------------------------------------------------------+-----------------------------------+-----------------------------------------+------------+------------------------+\nonly showing top 5 rows\n\n"
     ]
    }
   ],
   "source": [
    "file_path_general = \"file:/tmp/OP_DTL_GNRL_PGYR2023_P01302025_01212025.csv\"\n",
    "\n",
    "df_general = spark.read.format(\"csv\") \\\n",
    "    .option(\"header\", \"true\") \\\n",
    "    .option(\"inferSchema\", \"true\") \\\n",
    "    .load(file_path_general)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 0,
   "metadata": {
    "application/vnd.databricks.v1+cell": {
     "cellMetadata": {
      "byteLimit": 2048000,
      "rowLimit": 10000
     },
     "inputWidgets": {},
     "nuid": "ce23aeb7-2b2c-4666-a1aa-57b77b791f32",
     "showTitle": false,
     "tableResultSettingsMap": {},
     "title": ""
    }
   },
   "outputs": [
    {
     "output_type": "stream",
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "+-----------+--------------------+-------------+--------------------+---------------------+-------------------+---------------------+-----------------------------------------------+-----------------------------------------------+--------------+---------------+------------------+-----------------+------------------+---------------------+----------------------+--------------------+----------+------------+-------------------------------+-----------------+--------------------+---------------------------------------------------------+-----------------------------------------------------------+-------------------------------------------------------------+--------------------------------------------------------------+----------------------------------------------------------------+------------------------------+--------------------------------------------------------+------------------------+----------------------+--------------------------------+---------------------+--------------------+----------------------+----------------------------+---------------------+----------------------------+-----------------------------+---------------------------+-----------------------------+--------------------------------+--------------------------------+--------------------------------+--------------------------------+--------------------------------+--------------------------------+-----------------------------+-----------------------------+-----------------------------+-----------------------------+-----------------------------+-----------------------------+-------------------------------------+-------------------------------------+-------------------------------------+-------------------------------------+-------------------------------------+-----------------------------------------------+-----------------------------------+----------------------------+-----------------------------------+------------------------------------+----------------------------------+------------------------------------+------------------------------------------------------+------------------------------------------------------+-----------------------------+------------------------------+---------------------------------+--------------------------------+---------------------------------+------------------------------------+---------------------------------------+---------------------------------------+---------------------------------------+---------------------------------------+---------------------------------------+---------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+--------------------------------------------+--------------------------------------------+--------------------------------------------+--------------------------------------------+--------------------------------------------+-----------------------------------------------+-----------------------------------+----------------------------+-----------------------------------+------------------------------------+----------------------------------+------------------------------------+------------------------------------------------------+------------------------------------------------------+-----------------------------+------------------------------+---------------------------------+--------------------------------+---------------------------------+------------------------------------+---------------------------------------+---------------------------------------+---------------------------------------+---------------------------------------+---------------------------------------+---------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+--------------------------------------------+--------------------------------------------+--------------------------------------------+--------------------------------------------+--------------------------------------------+-----------------------------------------------+-----------------------------------+----------------------------+-----------------------------------+------------------------------------+----------------------------------+------------------------------------+------------------------------------------------------+------------------------------------------------------+-----------------------------+------------------------------+---------------------------------+--------------------------------+---------------------------------+------------------------------------+---------------------------------------+---------------------------------------+---------------------------------------+---------------------------------------+---------------------------------------+---------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+--------------------------------------------+--------------------------------------------+--------------------------------------------+--------------------------------------------+--------------------------------------------+-----------------------------------------------+-----------------------------------+----------------------------+-----------------------------------+------------------------------------+----------------------------------+------------------------------------+------------------------------------------------------+------------------------------------------------------+-----------------------------+------------------------------+---------------------------------+--------------------------------+---------------------------------+------------------------------------+---------------------------------------+---------------------------------------+---------------------------------------+---------------------------------------+---------------------------------------+---------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+--------------------------------------------+--------------------------------------------+--------------------------------------------+--------------------------------------------+--------------------------------------------+-----------------------------------------------+-----------------------------------+----------------------------+-----------------------------------+------------------------------------+----------------------------------+------------------------------------+------------------------------------------------------+------------------------------------------------------+-----------------------------+------------------------------+---------------------------------+--------------------------------+---------------------------------+------------------------------------+---------------------------------------+---------------------------------------+---------------------------------------+---------------------------------------+---------------------------------------+---------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+--------------------------------------------+--------------------------------------------+--------------------------------------------+--------------------------------------------+--------------------------------------------+-------------------------+---------------------------------+---------------------------------------------------------+--------------------------------------+--------------------------------------------------------+-----------------------------------+-----------------------------------------+---------------------------------+---------------------------------------------------------+--------------------------------------+--------------------------------------------------------+-----------------------------------+-----------------------------------------+---------------------------------+---------------------------------------------------------+--------------------------------------+--------------------------------------------------------+-----------------------------------+-----------------------------------------+---------------------------------+---------------------------------------------------------+--------------------------------------+--------------------------------------------------------+-----------------------------------+-----------------------------------------+---------------------------------+---------------------------------------------------------+--------------------------------------+--------------------------------------------------------+-----------------------------------+-----------------------------------------+---------------------------------+---------------+------------------------------------+---------------------+---------------------+---------------------+---------------------+---------------------+---------------------+------------------------------+------------------------------+-------------+-----------------------------+-------------------------+-------------------+-------------------------------------------+--------------------------------------+--------------+---------------+-----------------+-----------------------------+---------------------------------------+-----------------------------------------------------------------+-----------------+----------------------------------------------+----------------------+\n|Change_Type|Physician_Profile_ID|Physician_NPI|Physician_First_Name|Physician_Middle_Name|Physician_Last_Name|Physician_Name_Suffix|Recipient_Primary_Business_Street_Address_Line1|Recipient_Primary_Business_Street_Address_Line2|Recipient_City|Recipient_State|Recipient_Zip_Code|Recipient_Country|Recipient_Province|Recipient_Postal_Code|Physician_Primary_Type| Physician_Specialty| Record_ID|Program_Year|Total_Amount_Invested_USDollars|Value_of_Interest|   Terms_of_Interest|Submitting_Applicable_Manufacturer_or_Applicable_GPO_Name|Applicable_Manufacturer_or_Applicable_GPO_Making_Payment_ID|Applicable_Manufacturer_or_Applicable_GPO_Making_Payment_Name|Applicable_Manufacturer_or_Applicable_GPO_Making_Payment_State|Applicable_Manufacturer_or_Applicable_GPO_Making_Payment_Country|Dispute_Status_for_Publication|Interest_Held_by_Physician_or_an_Immediate_Family_Member|Payment_Publication_Date|Covered_Recipient_Type|Noncovered_Recipient_Entity_Name|Teaching_Hospital_CCN|Teaching_Hospital_ID|Teaching_Hospital_Name|Covered_Recipient_Profile_ID|Covered_Recipient_NPI|Covered_Recipient_First_Name|Covered_Recipient_Middle_Name|Covered_Recipient_Last_Name|Covered_Recipient_Name_Suffix|Covered_Recipient_Primary_Type_1|Covered_Recipient_Primary_Type_2|Covered_Recipient_Primary_Type_3|Covered_Recipient_Primary_Type_4|Covered_Recipient_Primary_Type_5|Covered_Recipient_Primary_Type_6|Covered_Recipient_Specialty_1|Covered_Recipient_Specialty_2|Covered_Recipient_Specialty_3|Covered_Recipient_Specialty_4|Covered_Recipient_Specialty_5|Covered_Recipient_Specialty_6|Covered_Recipient_License_State_code1|Covered_Recipient_License_State_code2|Covered_Recipient_License_State_code3|Covered_Recipient_License_State_code4|Covered_Recipient_License_State_code5|Principal_Investigator_1_Covered_Recipient_Type|Principal_Investigator_1_Profile_ID|Principal_Investigator_1_NPI|Principal_Investigator_1_First_Name|Principal_Investigator_1_Middle_Name|Principal_Investigator_1_Last_Name|Principal_Investigator_1_Name_Suffix|Principal_Investigator_1_Business_Street_Address_Line1|Principal_Investigator_1_Business_Street_Address_Line2|Principal_Investigator_1_City|Principal_Investigator_1_State|Principal_Investigator_1_Zip_Code|Principal_Investigator_1_Country|Principal_Investigator_1_Province|Principal_Investigator_1_Postal_Code|Principal_Investigator_1_Primary_Type_1|Principal_Investigator_1_Primary_Type_2|Principal_Investigator_1_Primary_Type_3|Principal_Investigator_1_Primary_Type_4|Principal_Investigator_1_Primary_Type_5|Principal_Investigator_1_Primary_Type_6|Principal_Investigator_1_Specialty_1|Principal_Investigator_1_Specialty_2|Principal_Investigator_1_Specialty_3|Principal_Investigator_1_Specialty_4|Principal_Investigator_1_Specialty_5|Principal_Investigator_1_Specialty_6|Principal_Investigator_1_License_State_code1|Principal_Investigator_1_License_State_code2|Principal_Investigator_1_License_State_code3|Principal_Investigator_1_License_State_code4|Principal_Investigator_1_License_State_code5|Principal_Investigator_2_Covered_Recipient_Type|Principal_Investigator_2_Profile_ID|Principal_Investigator_2_NPI|Principal_Investigator_2_First_Name|Principal_Investigator_2_Middle_Name|Principal_Investigator_2_Last_Name|Principal_Investigator_2_Name_Suffix|Principal_Investigator_2_Business_Street_Address_Line1|Principal_Investigator_2_Business_Street_Address_Line2|Principal_Investigator_2_City|Principal_Investigator_2_State|Principal_Investigator_2_Zip_Code|Principal_Investigator_2_Country|Principal_Investigator_2_Province|Principal_Investigator_2_Postal_Code|Principal_Investigator_2_Primary_Type_1|Principal_Investigator_2_Primary_Type_2|Principal_Investigator_2_Primary_Type_3|Principal_Investigator_2_Primary_Type_4|Principal_Investigator_2_Primary_Type_5|Principal_Investigator_2_Primary_Type_6|Principal_Investigator_2_Specialty_1|Principal_Investigator_2_Specialty_2|Principal_Investigator_2_Specialty_3|Principal_Investigator_2_Specialty_4|Principal_Investigator_2_Specialty_5|Principal_Investigator_2_Specialty_6|Principal_Investigator_2_License_State_code1|Principal_Investigator_2_License_State_code2|Principal_Investigator_2_License_State_code3|Principal_Investigator_2_License_State_code4|Principal_Investigator_2_License_State_code5|Principal_Investigator_3_Covered_Recipient_Type|Principal_Investigator_3_Profile_ID|Principal_Investigator_3_NPI|Principal_Investigator_3_First_Name|Principal_Investigator_3_Middle_Name|Principal_Investigator_3_Last_Name|Principal_Investigator_3_Name_Suffix|Principal_Investigator_3_Business_Street_Address_Line1|Principal_Investigator_3_Business_Street_Address_Line2|Principal_Investigator_3_City|Principal_Investigator_3_State|Principal_Investigator_3_Zip_Code|Principal_Investigator_3_Country|Principal_Investigator_3_Province|Principal_Investigator_3_Postal_Code|Principal_Investigator_3_Primary_Type_1|Principal_Investigator_3_Primary_Type_2|Principal_Investigator_3_Primary_Type_3|Principal_Investigator_3_Primary_Type_4|Principal_Investigator_3_Primary_Type_5|Principal_Investigator_3_Primary_Type_6|Principal_Investigator_3_Specialty_1|Principal_Investigator_3_Specialty_2|Principal_Investigator_3_Specialty_3|Principal_Investigator_3_Specialty_4|Principal_Investigator_3_Specialty_5|Principal_Investigator_3_Specialty_6|Principal_Investigator_3_License_State_code1|Principal_Investigator_3_License_State_code2|Principal_Investigator_3_License_State_code3|Principal_Investigator_3_License_State_code4|Principal_Investigator_3_License_State_code5|Principal_Investigator_4_Covered_Recipient_Type|Principal_Investigator_4_Profile_ID|Principal_Investigator_4_NPI|Principal_Investigator_4_First_Name|Principal_Investigator_4_Middle_Name|Principal_Investigator_4_Last_Name|Principal_Investigator_4_Name_Suffix|Principal_Investigator_4_Business_Street_Address_Line1|Principal_Investigator_4_Business_Street_Address_Line2|Principal_Investigator_4_City|Principal_Investigator_4_State|Principal_Investigator_4_Zip_Code|Principal_Investigator_4_Country|Principal_Investigator_4_Province|Principal_Investigator_4_Postal_Code|Principal_Investigator_4_Primary_Type_1|Principal_Investigator_4_Primary_Type_2|Principal_Investigator_4_Primary_Type_3|Principal_Investigator_4_Primary_Type_4|Principal_Investigator_4_Primary_Type_5|Principal_Investigator_4_Primary_Type_6|Principal_Investigator_4_Specialty_1|Principal_Investigator_4_Specialty_2|Principal_Investigator_4_Specialty_3|Principal_Investigator_4_Specialty_4|Principal_Investigator_4_Specialty_5|Principal_Investigator_4_Specialty_6|Principal_Investigator_4_License_State_code1|Principal_Investigator_4_License_State_code2|Principal_Investigator_4_License_State_code3|Principal_Investigator_4_License_State_code4|Principal_Investigator_4_License_State_code5|Principal_Investigator_5_Covered_Recipient_Type|Principal_Investigator_5_Profile_ID|Principal_Investigator_5_NPI|Principal_Investigator_5_First_Name|Principal_Investigator_5_Middle_Name|Principal_Investigator_5_Last_Name|Principal_Investigator_5_Name_Suffix|Principal_Investigator_5_Business_Street_Address_Line1|Principal_Investigator_5_Business_Street_Address_Line2|Principal_Investigator_5_City|Principal_Investigator_5_State|Principal_Investigator_5_Zip_Code|Principal_Investigator_5_Country|Principal_Investigator_5_Province|Principal_Investigator_5_Postal_Code|Principal_Investigator_5_Primary_Type_1|Principal_Investigator_5_Primary_Type_2|Principal_Investigator_5_Primary_Type_3|Principal_Investigator_5_Primary_Type_4|Principal_Investigator_5_Primary_Type_5|Principal_Investigator_5_Primary_Type_6|Principal_Investigator_5_Specialty_1|Principal_Investigator_5_Specialty_2|Principal_Investigator_5_Specialty_3|Principal_Investigator_5_Specialty_4|Principal_Investigator_5_Specialty_5|Principal_Investigator_5_Specialty_6|Principal_Investigator_5_License_State_code1|Principal_Investigator_5_License_State_code2|Principal_Investigator_5_License_State_code3|Principal_Investigator_5_License_State_code4|Principal_Investigator_5_License_State_code5|Related_Product_Indicator|Covered_or_Noncovered_Indicator_1|Indicate_Drug_or_Biological_or_Device_or_Medical_Supply_1|Product_Category_or_Therapeutic_Area_1|Name_of_Drug_or_Biological_or_Device_or_Medical_Supply_1|Associated_Drug_or_Biological_NDC_1|Associated_Device_or_Medical_Supply_PDI_1|Covered_or_Noncovered_Indicator_2|Indicate_Drug_or_Biological_or_Device_or_Medical_Supply_2|Product_Category_or_Therapeutic_Area_2|Name_of_Drug_or_Biological_or_Device_or_Medical_Supply_2|Associated_Drug_or_Biological_NDC_2|Associated_Device_or_Medical_Supply_PDI_2|Covered_or_Noncovered_Indicator_3|Indicate_Drug_or_Biological_or_Device_or_Medical_Supply_3|Product_Category_or_Therapeutic_Area_3|Name_of_Drug_or_Biological_or_Device_or_Medical_Supply_3|Associated_Drug_or_Biological_NDC_3|Associated_Device_or_Medical_Supply_PDI_3|Covered_or_Noncovered_Indicator_4|Indicate_Drug_or_Biological_or_Device_or_Medical_Supply_4|Product_Category_or_Therapeutic_Area_4|Name_of_Drug_or_Biological_or_Device_or_Medical_Supply_4|Associated_Drug_or_Biological_NDC_4|Associated_Device_or_Medical_Supply_PDI_4|Covered_or_Noncovered_Indicator_5|Indicate_Drug_or_Biological_or_Device_or_Medical_Supply_5|Product_Category_or_Therapeutic_Area_5|Name_of_Drug_or_Biological_or_Device_or_Medical_Supply_5|Associated_Drug_or_Biological_NDC_5|Associated_Device_or_Medical_Supply_PDI_5|Total_Amount_of_Payment_USDollars|Date_of_Payment|Form_of_Payment_or_Transfer_of_Value|Expenditure_Category1|Expenditure_Category2|Expenditure_Category3|Expenditure_Category4|Expenditure_Category5|Expenditure_Category6|Preclinical_Research_Indicator|Delay_in_Publication_Indicator|Name_of_Study|ClinicalTrials_Gov_Identifier|Research_Information_Link|Context_of_Research|Number_of_Payments_Included_in_Total_Amount|Nature_of_Payment_or_Transfer_of_Value|City_of_Travel|State_of_Travel|Country_of_Travel|Physician_Ownership_Indicator|Third_Party_Payment_Recipient_Indicator|Name_of_Third_Party_Entity_Receiving_Payment_or_Transfer_of_Value|Charity_Indicator|Third_Party_Equals_Covered_Recipient_Indicator|Contextual_Information|\n+-----------+--------------------+-------------+--------------------+---------------------+-------------------+---------------------+-----------------------------------------------+-----------------------------------------------+--------------+---------------+------------------+-----------------+------------------+---------------------+----------------------+--------------------+----------+------------+-------------------------------+-----------------+--------------------+---------------------------------------------------------+-----------------------------------------------------------+-------------------------------------------------------------+--------------------------------------------------------------+----------------------------------------------------------------+------------------------------+--------------------------------------------------------+------------------------+----------------------+--------------------------------+---------------------+--------------------+----------------------+----------------------------+---------------------+----------------------------+-----------------------------+---------------------------+-----------------------------+--------------------------------+--------------------------------+--------------------------------+--------------------------------+--------------------------------+--------------------------------+-----------------------------+-----------------------------+-----------------------------+-----------------------------+-----------------------------+-----------------------------+-------------------------------------+-------------------------------------+-------------------------------------+-------------------------------------+-------------------------------------+-----------------------------------------------+-----------------------------------+----------------------------+-----------------------------------+------------------------------------+----------------------------------+------------------------------------+------------------------------------------------------+------------------------------------------------------+-----------------------------+------------------------------+---------------------------------+--------------------------------+---------------------------------+------------------------------------+---------------------------------------+---------------------------------------+---------------------------------------+---------------------------------------+---------------------------------------+---------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+--------------------------------------------+--------------------------------------------+--------------------------------------------+--------------------------------------------+--------------------------------------------+-----------------------------------------------+-----------------------------------+----------------------------+-----------------------------------+------------------------------------+----------------------------------+------------------------------------+------------------------------------------------------+------------------------------------------------------+-----------------------------+------------------------------+---------------------------------+--------------------------------+---------------------------------+------------------------------------+---------------------------------------+---------------------------------------+---------------------------------------+---------------------------------------+---------------------------------------+---------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+--------------------------------------------+--------------------------------------------+--------------------------------------------+--------------------------------------------+--------------------------------------------+-----------------------------------------------+-----------------------------------+----------------------------+-----------------------------------+------------------------------------+----------------------------------+------------------------------------+------------------------------------------------------+------------------------------------------------------+-----------------------------+------------------------------+---------------------------------+--------------------------------+--------------------\n\n*** WARNING: max output size exceeded, skipping output. ***\n\n+---------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+--------------------------------------------+--------------------------------------------+--------------------------------------------+--------------------------------------------+--------------------------------------------+-----------------------------------------------+-----------------------------------+----------------------------+-----------------------------------+------------------------------------+----------------------------------+------------------------------------+------------------------------------------------------+------------------------------------------------------+-----------------------------+------------------------------+---------------------------------+--------------------------------+---------------------------------+------------------------------------+---------------------------------------+---------------------------------------+---------------------------------------+---------------------------------------+---------------------------------------+---------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+--------------------------------------------+--------------------------------------------+--------------------------------------------+--------------------------------------------+--------------------------------------------+-----------------------------------------------+-----------------------------------+----------------------------+-----------------------------------+------------------------------------+----------------------------------+------------------------------------+------------------------------------------------------+------------------------------------------------------+-----------------------------+------------------------------+---------------------------------+--------------------------------+---------------------------------+------------------------------------+---------------------------------------+---------------------------------------+---------------------------------------+---------------------------------------+---------------------------------------+---------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+--------------------------------------------+--------------------------------------------+--------------------------------------------+--------------------------------------------+--------------------------------------------+-----------------------------------------------+-----------------------------------+----------------------------+-----------------------------------+------------------------------------+----------------------------------+------------------------------------+------------------------------------------------------+------------------------------------------------------+-----------------------------+------------------------------+---------------------------------+--------------------------------+---------------------------------+------------------------------------+---------------------------------------+---------------------------------------+---------------------------------------+---------------------------------------+---------------------------------------+---------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+------------------------------------+--------------------------------------------+--------------------------------------------+--------------------------------------------+--------------------------------------------+--------------------------------------------+-------------------------+---------------------------------+---------------------------------------------------------+--------------------------------------+--------------------------------------------------------+-----------------------------------+-----------------------------------------+---------------------------------+---------------------------------------------------------+--------------------------------------+--------------------------------------------------------+-----------------------------------+-----------------------------------------+---------------------------------+---------------------------------------------------------+--------------------------------------+--------------------------------------------------------+-----------------------------------+-----------------------------------------+---------------------------------+---------------------------------------------------------+--------------------------------------+--------------------------------------------------------+-----------------------------------+-----------------------------------------+---------------------------------+---------------------------------------------------------+--------------------------------------+--------------------------------------------------------+-----------------------------------+-----------------------------------------+---------------------------------+---------------+------------------------------------+---------------------+---------------------+---------------------+---------------------+---------------------+---------------------+------------------------------+------------------------------+-------------+-----------------------------+-------------------------+-------------------+-------------------------------------------+--------------------------------------+--------------+---------------+-----------------+-----------------------------+---------------------------------------+-----------------------------------------------------------------+-----------------+----------------------------------------------+----------------------+\nonly showing top 5 rows\n\nroot\n |-- Change_Type: string (nullable = true)\n |-- Physician_Profile_ID: string (nullable = true)\n |-- Physician_NPI: string (nullable = true)\n |-- Physician_First_Name: string (nullable = true)\n |-- Physician_Middle_Name: string (nullable = true)\n |-- Physician_Last_Name: string (nullable = true)\n |-- Physician_Name_Suffix: string (nullable = true)\n |-- Recipient_Primary_Business_Street_Address_Line1: string (nullable = true)\n |-- Recipient_Primary_Business_Street_Address_Line2: string (nullable = true)\n |-- Recipient_City: string (nullable = true)\n |-- Recipient_State: string (nullable = true)\n |-- Recipient_Zip_Code: string (nullable = true)\n |-- Recipient_Country: string (nullable = true)\n |-- Recipient_Province: string (nullable = true)\n |-- Recipient_Postal_Code: string (nullable = true)\n |-- Physician_Primary_Type: string (nullable = true)\n |-- Physician_Specialty: string (nullable = true)\n |-- Record_ID: string (nullable = true)\n |-- Program_Year: string (nullable = true)\n |-- Total_Amount_Invested_USDollars: double (nullable = true)\n |-- Value_of_Interest: double (nullable = true)\n |-- Terms_of_Interest: string (nullable = true)\n |-- Submitting_Applicable_Manufacturer_or_Applicable_GPO_Name: string (nullable = true)\n |-- Applicable_Manufacturer_or_Applicable_GPO_Making_Payment_ID: string (nullable = true)\n |-- Applicable_Manufacturer_or_Applicable_GPO_Making_Payment_Name: string (nullable = true)\n |-- Applicable_Manufacturer_or_Applicable_GPO_Making_Payment_State: string (nullable = true)\n |-- Applicable_Manufacturer_or_Applicable_GPO_Making_Payment_Country: string (nullable = true)\n |-- Dispute_Status_for_Publication: string (nullable = true)\n |-- Interest_Held_by_Physician_or_an_Immediate_Family_Member: string (nullable = true)\n |-- Payment_Publication_Date: string (nullable = true)\n |-- Covered_Recipient_Type: string (nullable = true)\n |-- Noncovered_Recipient_Entity_Name: string (nullable = true)\n |-- Teaching_Hospital_CCN: string (nullable = true)\n |-- Teaching_Hospital_ID: string (nullable = true)\n |-- Teaching_Hospital_Name: string (nullable = true)\n |-- Covered_Recipient_Profile_ID: string (nullable = true)\n |-- Covered_Recipient_NPI: string (nullable = true)\n |-- Covered_Recipient_First_Name: string (nullable = true)\n |-- Covered_Recipient_Middle_Name: string (nullable = true)\n |-- Covered_Recipient_Last_Name: string (nullable = true)\n |-- Covered_Recipient_Name_Suffix: string (nullable = true)\n |-- Covered_Recipient_Primary_Type_1: string (nullable = true)\n |-- Covered_Recipient_Primary_Type_2: string (nullable = true)\n |-- Covered_Recipient_Primary_Type_3: string (nullable = true)\n |-- Covered_Recipient_Primary_Type_4: string (nullable = true)\n |-- Covered_Recipient_Primary_Type_5: string (nullable = true)\n |-- Covered_Recipient_Primary_Type_6: string (nullable = true)\n |-- Covered_Recipient_Specialty_1: string (nullable = true)\n |-- Covered_Recipient_Specialty_2: string (nullable = true)\n |-- Covered_Recipient_Specialty_3: string (nullable = true)\n |-- Covered_Recipient_Specialty_4: string (nullable = true)\n |-- Covered_Recipient_Specialty_5: string (nullable = true)\n |-- Covered_Recipient_Specialty_6: string (nullable = true)\n |-- Covered_Recipient_License_State_code1: string (nullable = true)\n |-- Covered_Recipient_License_State_code2: string (nullable = true)\n |-- Covered_Recipient_License_State_code3: string (nullable = true)\n |-- Covered_Recipient_License_State_code4: string (nullable = true)\n |-- Covered_Recipient_License_State_code5: string (nullable = true)\n |-- Principal_Investigator_1_Covered_Recipient_Type: string (nullable = true)\n |-- Principal_Investigator_1_Profile_ID: string (nullable = true)\n |-- Principal_Investigator_1_NPI: integer (nullable = true)\n |-- Principal_Investigator_1_First_Name: string (nullable = true)\n |-- Principal_Investigator_1_Middle_Name: string (nullable = true)\n |-- Principal_Investigator_1_Last_Name: string (nullable = true)\n |-- Principal_Investigator_1_Name_Suffix: string (nullable = true)\n |-- Principal_Investigator_1_Business_Street_Address_Line1: string (nullable = true)\n |-- Principal_Investigator_1_Business_Street_Address_Line2: string (nullable = true)\n |-- Principal_Investigator_1_City: string (nullable = true)\n |-- Principal_Investigator_1_State: string (nullable = true)\n |-- Principal_Investigator_1_Zip_Code: string (nullable = true)\n |-- Principal_Investigator_1_Country: string (nullable = true)\n |-- Principal_Investigator_1_Province: string (nullable = true)\n |-- Principal_Investigator_1_Postal_Code: string (nullable = true)\n |-- Principal_Investigator_1_Primary_Type_1: string (nullable = true)\n |-- Principal_Investigator_1_Primary_Type_2: string (nullable = true)\n |-- Principal_Investigator_1_Primary_Type_3: string (nullable = true)\n |-- Principal_Investigator_1_Primary_Type_4: string (nullable = true)\n |-- Principal_Investigator_1_Primary_Type_5: string (nullable = true)\n |-- Principal_Investigator_1_Primary_Type_6: string (nullable = true)\n |-- Principal_Investigator_1_Specialty_1: string (nullable = true)\n |-- Principal_Investigator_1_Specialty_2: string (nullable = true)\n |-- Principal_Investigator_1_Specialty_3: string (nullable = true)\n |-- Principal_Investigator_1_Specialty_4: string (nullable = true)\n |-- Principal_Investigator_1_Specialty_5: string (nullable = true)\n |-- Principal_Investigator_1_Specialty_6: string (nullable = true)\n |-- Principal_Investigator_1_License_State_code1: string (nullable = true)\n |-- Principal_Investigator_1_License_State_code2: string (nullable = true)\n |-- Principal_Investigator_1_License_State_code3: string (nullable = true)\n |-- Principal_Investigator_1_License_State_code4: string (nullable = true)\n |-- Principal_Investigator_1_License_State_code5: string (nullable = true)\n |-- Principal_Investigator_2_Covered_Recipient_Type: string (nullable = true)\n |-- Principal_Investigator_2_Profile_ID: integer (nullable = true)\n |-- Principal_Investigator_2_NPI: integer (nullable = true)\n |-- Principal_Investigator_2_First_Name: string (nullable = true)\n |-- Principal_Investigator_2_Middle_Name: string (nullable = true)\n |-- Principal_Investigator_2_Last_Name: string (nullable = true)\n |-- Principal_Investigator_2_Name_Suffix: string (nullable = true)\n |-- Principal_Investigator_2_Business_Street_Address_Line1: string (nullable = true)\n |-- Principal_Investigator_2_Business_Street_Address_Line2: string (nullable = true)\n |-- Principal_Investigator_2_City: string (nullable = true)\n |-- Principal_Investigator_2_State: string (nullable = true)\n |-- Principal_Investigator_2_Zip_Code: string (nullable = true)\n |-- Principal_Investigator_2_Country: string (nullable = true)\n |-- Principal_Investigator_2_Province: string (nullable = true)\n |-- Principal_Investigator_2_Postal_Code: string (nullable = true)\n |-- Principal_Investigator_2_Primary_Type_1: string (nullable = true)\n |-- Principal_Investigator_2_Primary_Type_2: string (nullable = true)\n |-- Principal_Investigator_2_Primary_Type_3: string (nullable = true)\n |-- Principal_Investigator_2_Primary_Type_4: string (nullable = true)\n |-- Principal_Investigator_2_Primary_Type_5: string (nullable = true)\n |-- Principal_Investigator_2_Primary_Type_6: string (nullable = true)\n |-- Principal_Investigator_2_Specialty_1: string (nullable = true)\n |-- Principal_Investigator_2_Specialty_2: string (nullable = true)\n |-- Principal_Investigator_2_Specialty_3: string (nullable = true)\n |-- Principal_Investigator_2_Specialty_4: string (nullable = true)\n |-- Principal_Investigator_2_Specialty_5: string (nullable = true)\n |-- Principal_Investigator_2_Specialty_6: string (nullable = true)\n |-- Principal_Investigator_2_License_State_code1: string (nullable = true)\n |-- Principal_Investigator_2_License_State_code2: string (nullable = true)\n |-- Principal_Investigator_2_License_State_code3: string (nullable = true)\n |-- Principal_Investigator_2_License_State_code4: string (nullable = true)\n |-- Principal_Investigator_2_License_State_code5: string (nullable = true)\n |-- Principal_Investigator_3_Covered_Recipient_Type: string (nullable = true)\n |-- Principal_Investigator_3_Profile_ID: integer (nullable = true)\n |-- Principal_Investigator_3_NPI: integer (nullable = true)\n |-- Principal_Investigator_3_First_Name: string (nullable = true)\n |-- Principal_Investigator_3_Middle_Name: string (nullable = true)\n |-- Principal_Investigator_3_Last_Name: string (nullable = true)\n |-- Principal_Investigator_3_Name_Suffix: string (nullable = true)\n |-- Principal_Investigator_3_Business_Street_Address_Line1: string (nullable = true)\n |-- Principal_Investigator_3_Business_Street_Address_Line2: string (nullable = true)\n |-- Principal_Investigator_3_City: string (nullable = true)\n |-- Principal_Investigator_3_State: string (nullable = true)\n |-- Principal_Investigator_3_Zip_Code: string (nullable = true)\n |-- Principal_Investigator_3_Country: string (nullable = true)\n |-- Principal_Investigator_3_Province: string (nullable = true)\n |-- Principal_Investigator_3_Postal_Code: string (nullable = true)\n |-- Principal_Investigator_3_Primary_Type_1: string (nullable = true)\n |-- Principal_Investigator_3_Primary_Type_2: string (nullable = true)\n |-- Principal_Investigator_3_Primary_Type_3: string (nullable = true)\n |-- Principal_Investigator_3_Primary_Type_4: string (nullable = true)\n |-- Principal_Investigator_3_Primary_Type_5: string (nullable = true)\n |-- Principal_Investigator_3_Primary_Type_6: string (nullable = true)\n |-- Principal_Investigator_3_Specialty_1: string (nullable = true)\n |-- Principal_Investigator_3_Specialty_2: string (nullable = true)\n |-- Principal_Investigator_3_Specialty_3: string (nullable = true)\n |-- Principal_Investigator_3_Specialty_4: string (nullable = true)\n |-- Principal_Investigator_3_Specialty_5: string (nullable = true)\n |-- Principal_Investigator_3_Specialty_6: string (nullable = true)\n |-- Principal_Investigator_3_License_State_code1: string (nullable = true)\n |-- Principal_Investigator_3_License_State_code2: string (nullable = true)\n |-- Principal_Investigator_3_License_State_code3: string (nullable = true)\n |-- Principal_Investigator_3_License_State_code4: string (nullable = true)\n |-- Principal_Investigator_3_License_State_code5: string (nullable = true)\n |-- Principal_Investigator_4_Covered_Recipient_Type: string (nullable = true)\n |-- Principal_Investigator_4_Profile_ID: integer (nullable = true)\n |-- Principal_Investigator_4_NPI: integer (nullable = true)\n |-- Principal_Investigator_4_First_Name: string (nullable = true)\n |-- Principal_Investigator_4_Middle_Name: string (nullable = true)\n |-- Principal_Investigator_4_Last_Name: string (nullable = true)\n |-- Principal_Investigator_4_Name_Suffix: string (nullable = true)\n |-- Principal_Investigator_4_Business_Street_Address_Line1: string (nullable = true)\n |-- Principal_Investigator_4_Business_Street_Address_Line2: string (nullable = true)\n |-- Principal_Investigator_4_City: string (nullable = true)\n |-- Principal_Investigator_4_State: string (nullable = true)\n |-- Principal_Investigator_4_Zip_Code: string (nullable = true)\n |-- Principal_Investigator_4_Country: string (nullable = true)\n |-- Principal_Investigator_4_Province: string (nullable = true)\n |-- Principal_Investigator_4_Postal_Code: string (nullable = true)\n |-- Principal_Investigator_4_Primary_Type_1: string (nullable = true)\n |-- Principal_Investigator_4_Primary_Type_2: string (nullable = true)\n |-- Principal_Investigator_4_Primary_Type_3: string (nullable = true)\n |-- Principal_Investigator_4_Primary_Type_4: string (nullable = true)\n |-- Principal_Investigator_4_Primary_Type_5: string (nullable = true)\n |-- Principal_Investigator_4_Primary_Type_6: string (nullable = true)\n |-- Principal_Investigator_4_Specialty_1: string (nullable = true)\n |-- Principal_Investigator_4_Specialty_2: string (nullable = true)\n |-- Principal_Investigator_4_Specialty_3: string (nullable = true)\n |-- Principal_Investigator_4_Specialty_4: string (nullable = true)\n |-- Principal_Investigator_4_Specialty_5: string (nullable = true)\n |-- Principal_Investigator_4_Specialty_6: string (nullable = true)\n |-- Principal_Investigator_4_License_State_code1: string (nullable = true)\n |-- Principal_Investigator_4_License_State_code2: string (nullable = true)\n |-- Principal_Investigator_4_License_State_code3: string (nullable = true)\n |-- Principal_Investigator_4_License_State_code4: string (nullable = true)\n |-- Principal_Investigator_4_License_State_code5: string (nullable = true)\n |-- Principal_Investigator_5_Covered_Recipient_Type: string (nullable = true)\n |-- Principal_Investigator_5_Profile_ID: integer (nullable = true)\n |-- Principal_Investigator_5_NPI: integer (nullable = true)\n |-- Principal_Investigator_5_First_Name: string (nullable = true)\n |-- Principal_Investigator_5_Middle_Name: string (nullable = true)\n |-- Principal_Investigator_5_Last_Name: string (nullable = true)\n |-- Principal_Investigator_5_Name_Suffix: string (nullable = true)\n |-- Principal_Investigator_5_Business_Street_Address_Line1: string (nullable = true)\n |-- Principal_Investigator_5_Business_Street_Address_Line2: string (nullable = true)\n |-- Principal_Investigator_5_City: string (nullable = true)\n |-- Principal_Investigator_5_State: string (nullable = true)\n |-- Principal_Investigator_5_Zip_Code: string (nullable = true)\n |-- Principal_Investigator_5_Country: string (nullable = true)\n |-- Principal_Investigator_5_Province: string (nullable = true)\n |-- Principal_Investigator_5_Postal_Code: string (nullable = true)\n |-- Principal_Investigator_5_Primary_Type_1: string (nullable = true)\n |-- Principal_Investigator_5_Primary_Type_2: string (nullable = true)\n |-- Principal_Investigator_5_Primary_Type_3: string (nullable = true)\n |-- Principal_Investigator_5_Primary_Type_4: string (nullable = true)\n |-- Principal_Investigator_5_Primary_Type_5: string (nullable = true)\n |-- Principal_Investigator_5_Primary_Type_6: string (nullable = true)\n |-- Principal_Investigator_5_Specialty_1: string (nullable = true)\n |-- Principal_Investigator_5_Specialty_2: string (nullable = true)\n |-- Principal_Investigator_5_Specialty_3: string (nullable = true)\n |-- Principal_Investigator_5_Specialty_4: string (nullable = true)\n |-- Principal_Investigator_5_Specialty_5: string (nullable = true)\n |-- Principal_Investigator_5_Specialty_6: string (nullable = true)\n |-- Principal_Investigator_5_License_State_code1: string (nullable = true)\n |-- Principal_Investigator_5_License_State_code2: string (nullable = true)\n |-- Principal_Investigator_5_License_State_code3: string (nullable = true)\n |-- Principal_Investigator_5_License_State_code4: string (nullable = true)\n |-- Principal_Investigator_5_License_State_code5: long (nullable = true)\n |-- Related_Product_Indicator: string (nullable = true)\n |-- Covered_or_Noncovered_Indicator_1: string (nullable = true)\n |-- Indicate_Drug_or_Biological_or_Device_or_Medical_Supply_1: string (nullable = true)\n |-- Product_Category_or_Therapeutic_Area_1: string (nullable = true)\n |-- Name_of_Drug_or_Biological_or_Device_or_Medical_Supply_1: string (nullable = true)\n |-- Associated_Drug_or_Biological_NDC_1: string (nullable = true)\n |-- Associated_Device_or_Medical_Supply_PDI_1: string (nullable = true)\n |-- Covered_or_Noncovered_Indicator_2: string (nullable = true)\n |-- Indicate_Drug_or_Biological_or_Device_or_Medical_Supply_2: string (nullable = true)\n |-- Product_Category_or_Therapeutic_Area_2: string (nullable = true)\n |-- Name_of_Drug_or_Biological_or_Device_or_Medical_Supply_2: string (nullable = true)\n |-- Associated_Drug_or_Biological_NDC_2: string (nullable = true)\n |-- Associated_Device_or_Medical_Supply_PDI_2: string (nullable = true)\n |-- Covered_or_Noncovered_Indicator_3: string (nullable = true)\n |-- Indicate_Drug_or_Biological_or_Device_or_Medical_Supply_3: string (nullable = true)\n |-- Product_Category_or_Therapeutic_Area_3: string (nullable = true)\n |-- Name_of_Drug_or_Biological_or_Device_or_Medical_Supply_3: string (nullable = true)\n |-- Associated_Drug_or_Biological_NDC_3: string (nullable = true)\n |-- Associated_Device_or_Medical_Supply_PDI_3: string (nullable = true)\n |-- Covered_or_Noncovered_Indicator_4: string (nullable = true)\n |-- Indicate_Drug_or_Biological_or_Device_or_Medical_Supply_4: string (nullable = true)\n |-- Product_Category_or_Therapeutic_Area_4: string (nullable = true)\n |-- Name_of_Drug_or_Biological_or_Device_or_Medical_Supply_4: string (nullable = true)\n |-- Associated_Drug_or_Biological_NDC_4: string (nullable = true)\n |-- Associated_Device_or_Medical_Supply_PDI_4: string (nullable = true)\n |-- Covered_or_Noncovered_Indicator_5: string (nullable = true)\n |-- Indicate_Drug_or_Biological_or_Device_or_Medical_Supply_5: string (nullable = true)\n |-- Product_Category_or_Therapeutic_Area_5: string (nullable = true)\n |-- Name_of_Drug_or_Biological_or_Device_or_Medical_Supply_5: string (nullable = true)\n |-- Associated_Drug_or_Biological_NDC_5: string (nullable = true)\n |-- Associated_Device_or_Medical_Supply_PDI_5: string (nullable = true)\n |-- Total_Amount_of_Payment_USDollars: string (nullable = true)\n |-- Date_of_Payment: string (nullable = true)\n |-- Form_of_Payment_or_Transfer_of_Value: string (nullable = true)\n |-- Expenditure_Category1: string (nullable = true)\n |-- Expenditure_Category2: string (nullable = true)\n |-- Expenditure_Category3: string (nullable = true)\n |-- Expenditure_Category4: string (nullable = true)\n |-- Expenditure_Category5: string (nullable = true)\n |-- Expenditure_Category6: string (nullable = true)\n |-- Preclinical_Research_Indicator: string (nullable = true)\n |-- Delay_in_Publication_Indicator: string (nullable = true)\n |-- Name_of_Study: string (nullable = true)\n |-- ClinicalTrials_Gov_Identifier: string (nullable = true)\n |-- Research_Information_Link: string (nullable = true)\n |-- Context_of_Research: string (nullable = true)\n |-- Number_of_Payments_Included_in_Total_Amount: string (nullable = true)\n |-- Nature_of_Payment_or_Transfer_of_Value: string (nullable = true)\n |-- City_of_Travel: string (nullable = true)\n |-- State_of_Travel: string (nullable = true)\n |-- Country_of_Travel: string (nullable = true)\n |-- Physician_Ownership_Indicator: string (nullable = true)\n |-- Third_Party_Payment_Recipient_Indicator: string (nullable = true)\n |-- Name_of_Third_Party_Entity_Receiving_Payment_or_Transfer_of_Value: string (nullable = true)\n |-- Charity_Indicator: string (nullable = true)\n |-- Third_Party_Equals_Covered_Recipient_Indicator: string (nullable = true)\n |-- Contextual_Information: string (nullable = true)\n\n"
     ]
    }
   ],
   "source": [
    "from pyspark.sql.functions import col, sum as _sum, concat_ws\n",
    "\n",
    "# === File paths ===\n",
    "file_location_open_payment_2 = \"/FileStore/tables/OP_DTL_OWNRSHP_PGYR2023_P01302025_01212025-1.csv\"\n",
    "file_location_open_payments_3 = \"/FileStore/tables/OP_DTL_RSRCH_PGYR2023_P01302025_01212025.csv\"\n",
    "file_path_general = \"file:/tmp/OP_DTL_GNRL_PGYR2023_P01302025_01212025.csv\"  \n",
    "\n",
    "# === Step 1: Load Ownership Payments ===\n",
    "df_ownership = spark.read.format(\"csv\") \\\n",
    "    .option(\"header\", \"true\") \\\n",
    "    .option(\"inferSchema\", \"true\") \\\n",
    "    .load(file_location_open_payment_2)\n",
    "\n",
    "# === Step 2: Load Research Payments ===\n",
    "df_research = spark.read.format(\"csv\") \\\n",
    "    .option(\"header\", \"true\") \\\n",
    "    .option(\"inferSchema\", \"true\") \\\n",
    "    .load(file_location_open_payments_3)\n",
    "\n",
    "# === Step 3: Load General Payments ===\n",
    "df_general = spark.read.format(\"csv\") \\\n",
    "    .option(\"header\", \"true\") \\\n",
    "    .option(\"inferSchema\", \"true\") \\\n",
    "    .load(file_path_general)\n",
    "\n",
    "# === Step 4: Combine All Three ===\n",
    "df_combined = df_ownership.unionByName(df_research, allowMissingColumns=True)\n",
    "df_all = df_combined.unionByName(df_general, allowMissingColumns=True)\n",
    "\n",
    "# === Step 5: Preview Combined Data ===\n",
    "df_all.show(5)\n",
    "df_all.printSchema()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 0,
   "metadata": {
    "application/vnd.databricks.v1+cell": {
     "cellMetadata": {
      "byteLimit": 2048000,
      "rowLimit": 10000
     },
     "inputWidgets": {},
     "nuid": "0670e0ac-d263-4331-ba7f-b8185b1db5e9",
     "showTitle": false,
     "tableResultSettingsMap": {},
     "title": ""
    }
   },
   "outputs": [],
   "source": [
    "from pyspark.sql.functions import col, regexp_replace, sum as _sum, count, desc, concat_ws\n",
    "\n",
    "df_all_cleaned = df_all.withColumn(\n",
    "    \"Amount_Cleaned\",\n",
    "    regexp_replace(col(\"Total_Amount_of_Payment_USDollars\"), \"[$,]\", \"\").cast(\"double\")\n",
    ")\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 0,
   "metadata": {
    "application/vnd.databricks.v1+cell": {
     "cellMetadata": {
      "byteLimit": 2048000,
      "rowLimit": 10000
     },
     "inputWidgets": {},
     "nuid": "8cb7d4b5-44aa-4e55-b09f-a496351a3e34",
     "showTitle": false,
     "tableResultSettingsMap": {},
     "title": ""
    }
   },
   "outputs": [
    {
     "output_type": "stream",
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "+----------------------------------------------------+------+\n|Form_of_Payment_or_Transfer_of_Value                |count |\n+----------------------------------------------------+------+\n|Cash or cash equivalent                             |421862|\n|In-kind items and services                          |24308 |\n|Stock, stock option, or any other ownership interest|3     |\n+----------------------------------------------------+------+\n\n"
     ]
    }
   ],
   "source": [
    "df_q1 = df_filtered.filter(col(\"Total_Amount_of_Payment_USDollars\") > 1000) \\\n",
    "    .groupBy(\"Form_of_Payment_or_Transfer_of_Value\") \\\n",
    "    .count() \\\n",
    "    .orderBy(col(\"count\").desc())\n",
    "\n",
    "df_q1.show(truncate=False)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 0,
   "metadata": {
    "application/vnd.databricks.v1+cell": {
     "cellMetadata": {
      "byteLimit": 2048000,
      "rowLimit": 10000
     },
     "inputWidgets": {},
     "nuid": "2edf29c4-fb04-4c7a-a6b4-24f7df97723d",
     "showTitle": false,
     "tableResultSettingsMap": {},
     "title": ""
    }
   },
   "outputs": [
    {
     "output_type": "stream",
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "+----------------------------------------------------+------+\n|Form_of_Payment_or_Transfer_of_Value                |count |\n+----------------------------------------------------+------+\n|Cash or cash equivalent                             |871107|\n|In-kind items and services                          |156809|\n|null                                                |4434  |\n|2023                                                |6     |\n|Stock, stock option, or any other ownership interest|3     |\n+----------------------------------------------------+------+\n\n"
     ]
    }
   ],
   "source": [
    "df_q2 = df_filtered.groupBy(\"Form_of_Payment_or_Transfer_of_Value\") \\\n",
    "    .count() \\\n",
    "    .orderBy(col(\"count\").desc()) \\\n",
    "    .limit(10)\n",
    "\n",
    "df_q2.show(truncate=False)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 0,
   "metadata": {
    "application/vnd.databricks.v1+cell": {
     "cellMetadata": {
      "byteLimit": 2048000,
      "rowLimit": 10000
     },
     "inputWidgets": {},
     "nuid": "e0e725fe-f358-48b1-8ca4-eb41327cdec5",
     "showTitle": false,
     "tableResultSettingsMap": {},
     "title": ""
    }
   },
   "outputs": [
    {
     "output_type": "stream",
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "+----------------------------------------------------+-------------------+\n|Form_of_Payment_or_Transfer_of_Value                |Total_Payment      |\n+----------------------------------------------------+-------------------+\n|Cash or cash equivalent                             |6.425417513020019E9|\n|In-kind items and services                          |1.646168272299991E9|\n|Stock, stock option, or any other ownership interest|38562.479999999996 |\n|null                                                |null               |\n|2023                                                |null               |\n+----------------------------------------------------+-------------------+\n\n"
     ]
    }
   ],
   "source": [
    "df_q3 = df_filtered.groupBy(\"Form_of_Payment_or_Transfer_of_Value\") \\\n",
    "    .agg(_sum(\"Total_Amount_of_Payment_USDollars\").alias(\"Total_Payment\")) \\\n",
    "    .orderBy(col(\"Total_Payment\").desc()) \\\n",
    "    .limit(10)\n",
    "\n",
    "df_q3.show(truncate=False)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 0,
   "metadata": {
    "application/vnd.databricks.v1+cell": {
     "cellMetadata": {
      "byteLimit": 2048000,
      "rowLimit": 10000
     },
     "inputWidgets": {},
     "nuid": "4cbc21f1-7b9d-497e-ab5a-6d1dd36f9839",
     "showTitle": false,
     "tableResultSettingsMap": {},
     "title": ""
    }
   },
   "outputs": [
    {
     "output_type": "stream",
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "+------------------------------------------------------------------------------+-------------------+\n|Physician_Specialty                                                           |Total_Payment      |\n+------------------------------------------------------------------------------+-------------------+\n|null                                                                          |8.071624347800086E9|\n|Allopathic & Osteopathic Physicians|Ophthalmology|Retina Specialist           |null               |\n|Allopathic & Osteopathic Physicians|Pediatrics|Pediatric Pulmonology          |null               |\n|Allopathic & Osteopathic Physicians|Surgery                                   |null               |\n|Allopathic & Osteopathic Physicians|Orthopaedic Surgery|Foot and Ankle Surgery|null               |\n|Allopathic & Osteopathic Physicians|Psychiatry & Neurology|Psychiatry         |null               |\n|Allopathic & Osteopathic Physicians|Plastic Surgery                           |null               |\n|Allopathic & Osteopathic Physicians|Radiology|Nuclear Radiology               |null               |\n|Allopathic & Osteopathic Physicians|Psychiatry & Neurology|Pain Medicine      |null               |\n|Allopathic & Osteopathic Physicians|Neuromusculoskeletal Medicine & OMM       |null               |\n+------------------------------------------------------------------------------+-------------------+\n\n"
     ]
    }
   ],
   "source": [
    "df_q4 = df_filtered.groupBy(\"Physician_Specialty\") \\\n",
    "    .agg(_sum(\"Total_Amount_of_Payment_USDollars\").alias(\"Total_Payment\")) \\\n",
    "    .orderBy(col(\"Total_Payment\").desc()) \\\n",
    "    .limit(10)\n",
    "\n",
    "df_q4.show(truncate=False)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 0,
   "metadata": {
    "application/vnd.databricks.v1+cell": {
     "cellMetadata": {
      "byteLimit": 2048000,
      "rowLimit": 10000
     },
     "inputWidgets": {},
     "nuid": "57207509-e31d-46b2-a90f-2b03019885cf",
     "showTitle": false,
     "tableResultSettingsMap": {},
     "title": ""
    }
   },
   "outputs": [
    {
     "output_type": "stream",
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "+--------------+-------------------+\n|Physician_Name|Total_Payment      |\n+--------------+-------------------+\n|              |8.071624347800086E9|\n|Hal Brown     |null               |\n|John Welsh    |null               |\n|Nathan Drourr |null               |\n|Susan Crockett|null               |\n|Tarun Bhargava|null               |\n|Nadim Hawa    |null               |\n|Craig Dickman |null               |\n|KENNETH CHI   |null               |\n|Stephan Pill  |null               |\n+--------------+-------------------+\n\n"
     ]
    }
   ],
   "source": [
    "df_q5 = df_filtered.withColumn(\"Physician_Name\", concat_ws(\" \", \n",
    "                                                          col(\"Physician_First_Name\"), \n",
    "                                                          col(\"Physician_Last_Name\"))) \\\n",
    "    .groupBy(\"Physician_Name\") \\\n",
    "    .agg(_sum(\"Total_Amount_of_Payment_USDollars\").alias(\"Total_Payment\")) \\\n",
    "    .orderBy(col(\"Total_Payment\").desc()) \\\n",
    "    .limit(10)\n",
    "\n",
    "df_q5.show(truncate=False)\n"
   ]
  }
 ],
 "metadata": {
  "application/vnd.databricks.v1+notebook": {
   "computePreferences": null,
   "dashboards": [],
   "environmentMetadata": {
    "base_environment": "",
    "client": "1"
   },
   "language": "python",
   "notebookMetadata": {
    "pythonIndentUnit": 4
   },
   "notebookName": "Untitled Notebook 2025-03-23 20:05:31",
   "widgets": {}
  }
 },
 "nbformat": 4,
 "nbformat_minor": 0
}
